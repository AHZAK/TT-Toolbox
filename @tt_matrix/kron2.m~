function [tt]=kron2(tt1,tt2)
%[TT]=KRON2(TT1,TT2)
%Computes Kronecker product of two TT-matrices in non-standard
%ordering

%Zaglushka!
n1=tt1.n; m1=tt1.m; n2=tt2.n; m2=tt2.m;
t1=tt1.tt; t2=tt2.tt;
cr1=t1.core; cr2=t2.core; r1=t1.r; r2=t2.r; ps1=t1.ps; ps2=t2.ps;
d=t1.d;
r=r1.*r2;
n=n1.*n2;  
m=m1.*m2;
sz=dot(n.*r(1:d),r(2:d+1));
pos=(n.*r(1:d)).*r(2:d+1);
cr=zeros(sz,1);
for i=1:d
   core1=cr1(ps1(i):ps1(i+1)-1);
   core2=cr2(ps2(i):ps2(i+1)-1);
   core1=core1(:);
   core2=core2(:);
   %
end
return
end